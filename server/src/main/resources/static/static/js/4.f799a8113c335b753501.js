webpackJsonp([4],{M0w5:function(t,a){},f0Eh:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var i={name:"enquiry",data:function(){return{message:"",total:0,pageNo:1,pageSize:10,dataList:[],supplierList:[],materialList:[],addModel:!1,id:"",materialId:"",materialName:"",supplierId:"",supplierName:"",price:"",unit:"",belongId:"",editModel:!1}},components:{},methods:{toSearch:function(){this.pageNo=1,this.loadData()},loadData:function(){var t=this;this.$axios({method:"get",url:"enquiry/page",params:{materialName:this.message,pageIndex:this.pageNo,limit:this.pageSize}}).then(function(a){"200"==a.data.code?(t.dataList=a.data.pagination.datas,t.total=a.data.pagination.total&&a.data.pagination?a.data.pagination.total:0):t.$Message.error(a.data.msg)})},openSupplier:function(){this.materialId?this.loadSupplier(this.materialId):this.$Message.error("请先选择物料名称！")},loadSupplier:function(t){var a=this,e="";for(var i in this.materialList)t==this.materialList[i].materialId&&(e=this.materialList[i].materialName);if(e){this.supplierList=[];this.$axios({method:"get",url:"material/getSuppListByMaterialName",params:{materialName:e}}).then(function(t){"200"==t.data.code?a.supplierList=t.data.data:a.$Message.error(t.data.msg)})}},loadMaterial:function(){var t=this;this.$axios({method:"get",url:"material/list"}).then(function(a){"200"==a.data.code?t.materialList=a.data.data:t.$Message.error(a.data.msg)})},showAddmodel:function(){this.addModel=!0,this.id="",this.materialId="",this.materialName="",this.supplierId="",this.supplierName="",this.price="",this.unit=""},addCancel:function(){this.addModel=!1,this.id="",this.materialId="",this.materialName="",this.supplierId="",this.supplierName="",this.price="",this.unit=""},addConfirm:function(){var t=this;if(this.materialId)if(this.price){if(!this.supplierId)return this.$Message.error({content:"供应商不能为空",duration:2e3}),void unit;if(this.unit){this.$axios({method:"post",url:"enquiry/save",data:this.qs.stringify({supplierId:this.supplierId,materialId:this.materialId,price:this.price,unit:this.unit})}).then(function(a){"200"==a.data.code?(t.loadData(),t.addModel=!1,t.id="",t.materialId="",t.materialName="",t.supplierId="",t.supplierName="",t.price="",t.unit=""):t.$Message.error(a.data.msg)})}else this.$Message.error({content:"计量单位不能为空",duration:2e3})}else this.$Message.error({content:"价格不能为空",duration:2e3});else this.$Message.error({content:"物料名称不能为空",duration:2e3})},showEditModel:function(t,a,e,i,s,l,n,r){this.editModel=!0,this.id=t,this.materialId=a,this.materialName=e,this.supplierId=i,this.supplierName=s,this.price=l,this.unit=n,this.belongId=r},editCancel:function(){this.editModel=!1,this.id="",this.belongId="",this.materialId="",this.materialName="",this.supplierId="",this.supplierName="",this.price="",this.unit=""},editConfirm:function(){var t=this;if(this.materialId)if(this.price){if(!this.supplierId)return this.$Message.error({content:"供应商不能为空",duration:2e3}),void unit;if(this.unit){this.$axios({method:"post",url:"enquiry/update",data:this.qs.stringify({id:this.id,belongId:this.belongId,supplierId:this.supplierId,materialId:this.materialId,price:this.price,unit:this.unit})}).then(function(a){"200"==a.data.code?(t.loadData(),t.editModel=!1,t.id="",t.belongId="",t.materialId="",t.materialName="",t.supplierId="",t.supplierName="",t.price="",t.unit=""):t.$Message.error(a.data.msg)})}else this.$Message.error({content:"计量单位不能为空",duration:2e3})}else this.$Message.error({content:"价格不能为空",duration:2e3});else this.$Message.error({content:"物料名称不能为空",duration:2e3})},deleteEnquiry:function(t){var a=this;this.$axios({method:"post",url:"enquiry/deleteById",data:this.qs.stringify({id:t})}).then(function(t){"200"==t.data.code?(a.$Message.success(t.data.msg),a.loadData()):a.$Message.error(t.data.msg)})},changePage:function(t){this.pageNo=t,this.loadData()},toHistory:function(t){this.$router.push({path:"/enquiryHistory",query:{belongId:t}})}},mounted:function(){this.loadData(),this.loadMaterial()}},s={render:function(){var t=this,a=t.$createElement,i=t._self._c||a;return i("div",[i("div",{staticClass:"searchWrap"},[i("input",{directives:[{name:"model",rawName:"v-model",value:t.message,expression:"message"}],staticClass:"searchInput",attrs:{placeholder:"🔎搜索物料名称",type:"text"},domProps:{value:t.message},on:{input:function(a){a.target.composing||(t.message=a.target.value)}}}),t._v(" "),i("div",{staticClass:"searchText putHover",on:{click:t.toSearch}},[t._v("搜索")])]),t._v(" "),i("div",{staticClass:"titleWrap"},[i("div",{staticClass:"title"},[t._v("\n      询价信息列表：\n    ")]),t._v(" "),t._m(0),t._v(" "),i("div",{staticClass:"add putHover",on:{click:t.showAddmodel}},[t._v("\n      新增信息"),i("img",{attrs:{src:e("QBcd"),alt:""}})])]),t._v(" "),i("div",{staticClass:"listWrap "},[i("ul",{staticClass:"list shadow"},[t._m(1),t._v(" "),t.total<=0?i("li",{staticClass:"nodata"},[t._v("\n        暂无数据\n      ")]):t._l(t.dataList,function(a,e){return i("li",{key:e,staticClass:"listLi listContent"},[i("div",{staticClass:"leftText"},[t._v(t._s(a.materialId))]),t._v(" "),i("div",{staticClass:"leftText"},[t._v(t._s(a.materialName))]),t._v(" "),i("div",{staticClass:"li_div"},[t._v(t._s(a.supplierName))]),t._v(" "),i("div",{staticClass:"li_div"},[t._v(t._s(a.price))]),t._v(" "),i("div",{staticClass:"li_div"},[t._v(t._s(a.unit))]),t._v(" "),i("div",{staticClass:"operate"},[i("span",{staticClass:"edit putHover font_mr",on:{click:function(e){return t.showEditModel(a.id,a.materialId,a.materialName,a.supplierId,a.supplierName,a.price,a.unit,a.belongId)}}},[t._v("修改")]),t._v(" "),i("span",{staticClass:"history putHover font_mr",on:{click:function(e){return t.toHistory(a.belongId)}}},[t._v("历史定价")]),t._v(" "),i("span",{staticClass:"delete putHover font_mr",on:{click:function(e){return t.deleteEnquiry(a.id)}}},[t._v("删除")])])])})],2),t._v(" "),i("div",{staticClass:"pageWrap"},[i("Page",{attrs:{total:t.total,current:t.pageNo,"page-size":t.pageSize,"prev-text":"上一页","next-text":"下一页"},on:{"on-change":t.changePage}})],1),t._v(" "),i("div",[i("Modal",{staticClass:"modelWrap",attrs:{closable:!1,"mask-closable":!1,width:"360"},model:{value:t.addModel,callback:function(a){t.addModel=a},expression:"addModel"}},[i("p",{staticClass:"modelTitle",attrs:{slot:"header"},slot:"header"},[t._v("新增询价信息")]),t._v(" "),i("div",{staticClass:"modelContent"},[i("div",{staticClass:"type_content"},[i("span",{staticClass:"input_name"},[t._v("物料名称：")]),t._v(" "),i("Select",{staticStyle:{width:"120px"},attrs:{placeholder:"请选择物料名称",size:"small"},on:{"on-change":function(a){return t.loadSupplier(t.materialId)}},model:{value:t.materialId,callback:function(a){t.materialId=a},expression:"materialId"}},t._l(t.materialList,function(a){return i("Option",{key:a.materialId,attrs:{value:a.materialId}},[t._v(t._s(a.materialName))])}),1)],1),t._v(" "),i("div",{staticClass:"type_content"},[i("span",{staticClass:"input_name"},[t._v("供应商：")]),t._v(" "),i("Select",{staticStyle:{width:"120px"},attrs:{placeholder:"请选择供应商",size:"small"},model:{value:t.supplierId,callback:function(a){t.supplierId=a},expression:"supplierId"}},t._l(t.supplierList,function(a){return i("Option",{key:a.supplierId,attrs:{value:a.supplierId}},[t._v(t._s(a.supplierName))])}),1)],1),t._v(" "),i("div",{staticClass:"type_content"},[i("span",{staticClass:"input_name"},[t._v("价格：")]),t._v(" "),i("Input",{staticClass:"model_input",attrs:{type:"number",placeholder:"请输入价格"},model:{value:t.price,callback:function(a){t.price=a},expression:"price"}})],1),t._v(" "),i("div",{staticClass:"type_content"},[i("span",{staticClass:"input_name"},[t._v("计量单位：")]),t._v(" "),i("Input",{staticClass:"model_input",attrs:{type:"text",placeholder:"请输入计量单位"},model:{value:t.unit,callback:function(a){t.unit=a},expression:"unit"}})],1)]),t._v(" "),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("div",{staticClass:"modelBtnWraP"},[i("span",{staticClass:"cancel",on:{click:t.addCancel}},[t._v("取消")]),t._v(" "),i("span",{staticClass:"confirm",on:{click:t.addConfirm}},[t._v("确认")])])])]),t._v(" "),i("Modal",{staticClass:"modelWrap",attrs:{closable:!1,"mask-closable":!1,width:"360"},model:{value:t.editModel,callback:function(a){t.editModel=a},expression:"editModel"}},[i("p",{staticClass:"modelTitle",attrs:{slot:"header"},slot:"header"},[t._v("新增询价信息")]),t._v(" "),i("div",{staticClass:"modelContent"},[i("div",{staticClass:"type_content"},[i("span",{staticClass:"input_name"},[t._v("物料名称：")]),t._v(" "),i("Select",{staticStyle:{width:"120px"},attrs:{placeholder:"请选择物料名称",size:"small"},on:{"on-change":function(a){return t.loadSupplier(t.materialId)}},model:{value:t.materialId,callback:function(a){t.materialId=a},expression:"materialId"}},t._l(t.materialList,function(a){return i("Option",{key:a.materialId,attrs:{value:a.materialId}},[t._v(t._s(a.materialName))])}),1)],1),t._v(" "),i("div",{staticClass:"type_content"},[i("span",{staticClass:"input_name"},[t._v("供应商：")]),t._v(" "),i("Select",{staticStyle:{width:"120px"},attrs:{placeholder:"请选择供应商",size:"small"},model:{value:t.supplierId,callback:function(a){t.supplierId=a},expression:"supplierId"}},t._l(t.supplierList,function(a){return i("Option",{key:a.supplierId,attrs:{value:a.supplierId}},[t._v(t._s(a.supplierName))])}),1)],1),t._v(" "),i("div",{staticClass:"type_content"},[i("span",{staticClass:"input_name"},[t._v("价格：")]),t._v(" "),i("Input",{staticClass:"model_input",attrs:{type:"number",placeholder:"请输入价格"},model:{value:t.price,callback:function(a){t.price=a},expression:"price"}})],1),t._v(" "),i("div",{staticClass:"type_content"},[i("span",{staticClass:"input_name"},[t._v("计量单位：")]),t._v(" "),i("Input",{staticClass:"model_input",attrs:{type:"text",placeholder:"请输入计量单位"},model:{value:t.unit,callback:function(a){t.unit=a},expression:"unit"}})],1)]),t._v(" "),i("div",{attrs:{slot:"footer"},slot:"footer"},[i("div",{staticClass:"modelBtnWraP"},[i("span",{staticClass:"cancel",on:{click:t.editCancel}},[t._v("取消")]),t._v(" "),i("span",{staticClass:"confirm",on:{click:t.editConfirm}},[t._v("确认")])])])])],1)])])},staticRenderFns:[function(){var t=this.$createElement,a=this._self._c||t;return a("div",{staticClass:"titleRight"},[a("div",{staticClass:"count"},[this._v("\n        共有信息 "),a("span",{staticClass:"font_red font_blod font_mr"},[this._v("30")]),this._v("条\n      ")])])},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("li",{staticClass:"listTitle listLi"},[e("div",{staticClass:"leftText"},[t._v("物料编号")]),t._v(" "),e("div",{staticClass:"leftText"},[t._v("物料名称")]),t._v(" "),e("div",{staticClass:"li_div"},[t._v("供应商")]),t._v(" "),e("div",{staticClass:"li_div"},[t._v("价格")]),t._v(" "),e("div",{staticClass:"li_div"},[t._v("计量单位")]),t._v(" "),e("div",{staticClass:"operate"},[t._v("操作")])])}]};var l=e("VU/8")(i,s,!1,function(t){e("M0w5")},"data-v-e30f3336",null);a.default=l.exports}});
//# sourceMappingURL=4.f799a8113c335b753501.js.map